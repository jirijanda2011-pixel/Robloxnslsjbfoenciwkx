--[[
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                         ULTIMATE CHEAT SUITE                              â•‘
    â•‘                              Version 5.1                                  â•‘
    â•‘         Aimbot | Triggerbot | 30 Visual Features | Full GUI               â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
]]

-- Services
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local CoreGui = game:GetService("CoreGui")
local Workspace = game:GetService("Workspace")
local Stats = game:GetService("Stats")

local LocalPlayer = Players.LocalPlayer
local Camera = Workspace.CurrentCamera
local Mouse = LocalPlayer:GetMouse()

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- CONFIGURATION
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

local Config = {
    -- AIMBOT
    Aimbot = {
        Enabled = true,
        Key = Enum.UserInputType.MouseButton2,
        TeamCheck = true,
        VisCheck = true,
        TargetPart = "Head",
        FOV = 150,
        Smoothing = 2,
        Prediction = 0.13,
        TargetLock = true,
        MaxDistance = 1000,
    },
    
    -- TRIGGERBOT
    Triggerbot = {
        Enabled = false,
        Delay = 0.05,
        TeamCheck = true,
        BurstMode = false,
        BurstCount = 3,
        BurstDelay = 0.03,
    },
    
    -- ESP
    ESP = {
        Enabled = true,
        TeamCheck = true,
        MaxDistance = 2000,
        
        -- Box
        Box = true,
        BoxType = "Full",
        BoxColor = Color3.fromRGB(255, 0, 0),
        BoxThickness = 1,
        BoxOutline = true,
        
        -- Fill
        FillBox = false,
        FillColor = Color3.fromRGB(255, 0, 0),
        FillTransparency = 0.8,
        
        -- Skeleton
        Skeleton = true,
        SkeletonColor = Color3.fromRGB(255, 255, 255),
        
        -- Name
        Name = true,
        NameColor = Color3.fromRGB(255, 255, 255),
        
        -- Health
        HealthBar = true,
        HealthText = false,
        
        -- Info
        Distance = true,
        DistanceColor = Color3.fromRGB(180, 180, 180),
        Weapon = true,
        WeaponColor = Color3.fromRGB(255, 200, 100),
        
        -- Tracer
        Tracer = false,
        TracerOrigin = "Bottom",
        TracerColor = Color3.fromRGB(255, 0, 255),
        
        -- Head
        HeadDot = true,
        HeadDotColor = Color3.fromRGB(255, 0, 0),
        HeadCircle = false,
        HeadCircleColor = Color3.fromRGB(255, 255, 0),
        
        -- Extra
        LookDirection = false,
        LookColor = Color3.fromRGB(0, 255, 255),
        Flags = true,
        UseTeamColor = false,
    },
    
    -- SCREEN VISUALS
    Screen = {
        FOVCircle = true,
        FOVColor = Color3.fromRGB(255, 85, 255),
        
        Crosshair = true,
        CrosshairColor = Color3.fromRGB(0, 255, 128),
        CrosshairSize = 8,
        CrosshairGap = 4,
        CrosshairDot = true,
        
        TargetInfo = true,
        Watermark = true,
        FPS = true,
        Ping = true,
        PlayerCount = true,
        SpectatorList = true,
        KeybindList = true,
        TargetSnapline = true,
        SnaplineColor = Color3.fromRGB(255, 50, 50),
        HitMarker = true,
        HitMarkerColor = Color3.fromRGB(255, 0, 0),
    },
    
    -- WORLD
    World = {
        -- FOV Changer
        FOVChanger = false,
        FOVValue = 100,
        
        -- Fullbright
        Fullbright = false,
        
        -- Ambience
        NoFog = false,
        CustomTime = false,
        TimeValue = 12,
    },
    
    -- KEYS
    Keys = {
        Menu = Enum.KeyCode.Insert,
        Toggle = Enum.KeyCode.RightAlt,
        Panic = Enum.KeyCode.End,
    },
}

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- STATE
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

local State = {
    MenuOpen = true,
    AimTarget = nil,
    IsAiming = false,
    PanicMode = false,
    LastTriggerFire = 0,
    FPS = 0,
    FrameCount = 0,
    LastFPSUpdate = 0,
    HitMarkerTime = 0,
}

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- UTILITY
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

local function GetCenter()
    return Camera.ViewportSize / 2
end

local function WorldToScreen(pos)
    local screen, onScreen = Camera:WorldToViewportPoint(pos)
    return Vector2.new(screen.X, screen.Y), onScreen, screen.Z
end

local function GetDistance(pos)
    local char = LocalPlayer.Character
    if char and char:FindFirstChild("HumanoidRootPart") then
        return (char.HumanoidRootPart.Position - pos).Magnitude
    end
    return math.huge
end

local function IsTeammate(player)
    if not player then return false end
    local isTeam = false
    pcall(function()
        if player.Team and LocalPlayer.Team then
            isTeam = player.Team == LocalPlayer.Team
        end
    end)
    return isTeam
end

local function IsVisible(origin, targetPos, ignoreChar)
    local params = RaycastParams.new()
    params.FilterType = Enum.RaycastFilterType.Exclude
    params.FilterDescendantsInstances = {ignoreChar}
    
    local result = Workspace:Raycast(origin, (targetPos - origin), params)
    
    if result then
        for _, player in pairs(Players:GetPlayers()) do
            if player ~= LocalPlayer and player.Character then
                if result.Instance:IsDescendantOf(player.Character) then
                    return true
                end
            end
        end
        return false
    end
    return true
end

local function GetHealthColor(health, maxHealth)
    local ratio = math.clamp(health / maxHealth, 0, 1)
    return Color3.fromRGB(255 * (1 - ratio), 255 * ratio, 0)
end

local function GetWeaponName(char)
    if not char then return "None" end
    for _, tool in pairs(char:GetChildren()) do
        if tool:IsA("Tool") then
            return tool.Name
        end
    end
    return "None"
end

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- ESP SYSTEM (BULLETPROOF)
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

local Bones = {
    {"Head", "UpperTorso"},
    {"UpperTorso", "LowerTorso"},
    {"UpperTorso", "RightUpperArm"},
    {"RightUpperArm", "RightLowerArm"},
    {"RightLowerArm", "RightHand"},
    {"UpperTorso", "LeftUpperArm"},
    {"LeftUpperArm", "LeftLowerArm"},
    {"LeftLowerArm", "LeftHand"},
    {"LowerTorso", "RightUpperLeg"},
    {"RightUpperLeg", "RightLowerLeg"},
    {"RightLowerLeg", "RightFoot"},
    {"LowerTorso", "LeftUpperLeg"},
    {"LeftUpperLeg", "LeftLowerLeg"},
    {"LeftLowerLeg", "LeftFoot"},
}

local BonesR6 = {
    {"Head", "Torso"},
    {"Torso", "Right Arm"},
    {"Torso", "Left Arm"},
    {"Torso", "Right Leg"},
    {"Torso", "Left Leg"},
}

-- Simple ESP storage
local ESP = {}

local function DrawESP()
    -- Clear old drawings
    for _, data in pairs(ESP) do
        if data.Box then pcall(function() data.Box:Remove() end) end
        if data.BoxOutline then pcall(function() data.BoxOutline:Remove() end) end
        if data.Name then pcall(function() data.Name:Remove() end) end
        if data.Distance then pcall(function() data.Distance:Remove() end) end
        if data.Health then pcall(function() data.Health:Remove() end) end
        if data.HealthBg then pcall(function() data.HealthBg:Remove() end) end
        if data.HealthOutline then pcall(function() data.HealthOutline:Remove() end) end
        if data.Weapon then pcall(function() data.Weapon:Remove() end) end
        if data.HeadDot then pcall(function() data.HeadDot:Remove() end) end
        if data.Tracer then pcall(function() data.Tracer:Remove() end) end
        if data.Bones then
            for _, bone in pairs(data.Bones) do
                pcall(function() bone:Remove() end)
            end
        end
    end
    ESP = {}
    
    -- Don't draw if disabled or panic
    if not Config.ESP.Enabled or State.PanicMode then return end
    
    local myChar = LocalPlayer.Character
    if not myChar then return end
    
    local myRoot = myChar:FindFirstChild("HumanoidRootPart")
    local viewport = Camera.ViewportSize
    
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer then
            -- Team check
            local isTeam = false
            if Config.ESP.TeamCheck then
                pcall(function()
                    if player.Team and LocalPlayer.Team then
                        isTeam = player.Team == LocalPlayer.Team
                    end
                end)
            end
            
            if not isTeam then
                local char = player.Character
                if char then
                    local humanoid = char:FindFirstChildOfClass("Humanoid")
                    local root = char:FindFirstChild("HumanoidRootPart")
                    local head = char:FindFirstChild("Head")
                    
                    if humanoid and root and head and humanoid.Health > 0 then
                        -- Distance check
                        local dist = myRoot and (myRoot.Position - root.Position).Magnitude or 0
                        
                        if dist <= Config.ESP.MaxDistance then
                            local rootPos, onScreen = Camera:WorldToViewportPoint(root.Position)
                            
                            if onScreen then
                                local espData = {}
                                ESP[player] = espData
                                
                                -- Calculate box
                                local headPos = Camera:WorldToViewportPoint(head.Position + Vector3.new(0, 0.5, 0))
                                local footPos = Camera:WorldToViewportPoint(root.Position - Vector3.new(0, 3, 0))
                                
                                local boxHeight = math.abs(headPos.Y - footPos.Y)
                                local boxWidth = boxHeight * 0.6
                                local boxX = rootPos.X - boxWidth / 2
                                local boxY = headPos.Y
                                
                                local color = Config.ESP.BoxColor
                                
                                -- BOX
                                if Config.ESP.Box then
                                    if Config.ESP.BoxOutline then
                                        espData.BoxOutline = Drawing.new("Square")
                                        espData.BoxOutline.Size = Vector2.new(boxWidth, boxHeight)
                                        espData.BoxOutline.Position = Vector2.new(boxX, boxY)
                                        espData.BoxOutline.Color = Color3.new(0, 0, 0)
                                        espData.BoxOutline.Thickness = 3
                                        espData.BoxOutline.Filled = false
                                        espData.BoxOutline.Visible = true
                                    end
                                    
                                    espData.Box = Drawing.new("Square")
                                    espData.Box.Size = Vector2.new(boxWidth, boxHeight)
                                    espData.Box.Position = Vector2.new(boxX, boxY)
                                    espData.Box.Color = color
                                    espData.Box.Thickness = 1
                                    espData.Box.Filled = false
                                    espData.Box.Visible = true
                                end
                                
                                -- NAME
                                if Config.ESP.Name then
                                    espData.Name = Drawing.new("Text")
                                    espData.Name.Text = player.Name
                                    espData.Name.Position = Vector2.new(rootPos.X, boxY - 16)
                                    espData.Name.Color = Color3.new(1, 1, 1)
                                    espData.Name.Size = 13
                                    espData.Name.Center = true
                                    espData.Name.Outline = true
                                    espData.Name.Visible = true
                                end
                                
                                -- DISTANCE
                                if Config.ESP.Distance then
                                    espData.Distance = Drawing.new("Text")
                                    espData.Distance.Text = string.format("[%dm]", math.floor(dist))
                                    espData.Distance.Position = Vector2.new(rootPos.X, boxY + boxHeight + 2)
                                    espData.Distance.Color = Color3.fromRGB(180, 180, 180)
                                    espData.Distance.Size = 11
                                    espData.Distance.Center = true
                                    espData.Distance.Outline = true
                                    espData.Distance.Visible = true
                                end
                                
                                -- WEAPON
                                if Config.ESP.Weapon then
                                    local weapon = "None"
                                    for _, tool in pairs(char:GetChildren()) do
                                        if tool:IsA("Tool") then
                                            weapon = tool.Name
                                            break
                                        end
                                    end
                                    
                                    espData.Weapon = Drawing.new("Text")
                                    espData.Weapon.Text = weapon
                                    espData.Weapon.Position = Vector2.new(rootPos.X, boxY + boxHeight + (Config.ESP.Distance and 14 or 2))
                                    espData.Weapon.Color = Color3.fromRGB(255, 200, 100)
                                    espData.Weapon.Size = 11
                                    espData.Weapon.Center = true
                                    espData.Weapon.Outline = true
                                    espData.Weapon.Visible = true
                                end
                                
                                -- HEALTH BAR
                                if Config.ESP.HealthBar then
                                    local healthRatio = humanoid.Health / humanoid.MaxHealth
                                    local barWidth2 = 3
                                    local barX2 = boxX - barWidth2 - 3
                                    local filledHeight = boxHeight * healthRatio
                                    
                                    local healthColor = Color3.fromRGB(255 * (1 - healthRatio), 255 * healthRatio, 0)
                                    
                                    espData.HealthOutline = Drawing.new("Square")
                                    espData.HealthOutline.Position = Vector2.new(barX2 - 1, boxY - 1)
                                    espData.HealthOutline.Size = Vector2.new(barWidth2 + 2, boxHeight + 2)
                                    espData.HealthOutline.Color = Color3.new(0, 0, 0)
                                    espData.HealthOutline.Filled = true
                                    espData.HealthOutline.Visible = true
                                    
                                    espData.HealthBg = Drawing.new("Square")
                                    espData.HealthBg.Position = Vector2.new(barX2, boxY)
                                    espData.HealthBg.Size = Vector2.new(barWidth2, boxHeight)
                                    espData.HealthBg.Color = Color3.fromRGB(40, 40, 40)
                                    espData.HealthBg.Filled = true
                                    espData.HealthBg.Visible = true
                                    
                                    espData.Health = Drawing.new("Square")
                                    espData.Health.Position = Vector2.new(barX2, boxY + (boxHeight - filledHeight))
                                    espData.Health.Size = Vector2.new(barWidth2, filledHeight)
                                    espData.Health.Color = healthColor
                                    espData.Health.Filled = true
                                    espData.Health.Visible = true
                                end
                                
                                -- HEAD DOT
                                if Config.ESP.HeadDot then
                                    local headScreen = Camera:WorldToViewportPoint(head.Position)
                                    
                                    espData.HeadDot = Drawing.new("Circle")
                                    espData.HeadDot.Position = Vector2.new(headScreen.X, headScreen.Y)
                                    espData.HeadDot.Radius = math.clamp(500 / rootPos.Z, 3, 6)
                                    espData.HeadDot.Color = Color3.fromRGB(255, 0, 0)
                                    espData.HeadDot.Filled = true
                                    espData.HeadDot.NumSides = 12
                                    espData.HeadDot.Visible = true
                                end
                                
                                -- TRACER
                                if Config.ESP.Tracer then
                                    espData.Tracer = Drawing.new("Line")
                                    espData.Tracer.From = Vector2.new(viewport.X / 2, viewport.Y)
                                    espData.Tracer.To = Vector2.new(rootPos.X, boxY + boxHeight)
                                    espData.Tracer.Color = Color3.fromRGB(255, 0, 255)
                                    espData.Tracer.Thickness = 1
                                    espData.Tracer.Visible = true
                                end
                                
                                -- SKELETON
                                if Config.ESP.Skeleton then
                                    espData.Bones = {}
                                    local boneSet = humanoid.RigType == Enum.HumanoidRigType.R15 and Bones or BonesR6
                                    
                                    for i, connection in ipairs(boneSet) do
                                        local part1 = char:FindFirstChild(connection[1])
                                        local part2 = char:FindFirstChild(connection[2])
                                        
                                        if part1 and part2 then
                                            local p1 = Camera:WorldToViewportPoint(part1.Position)
                                            local p2 = Camera:WorldToViewportPoint(part2.Position)
                                            
                                            if p1.Z > 0 and p2.Z > 0 then
                                                local bone = Drawing.new("Line")
                                                bone.From = Vector2.new(p1.X, p1.Y)
                                                bone.To = Vector2.new(p2.X, p2.Y)
                                                bone.Color = Color3.new(1, 1, 1)
                                                bone.Thickness = 1.5
                                                bone.Visible = true
                                                table.insert(espData.Bones, bone)
                                            end
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
end

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- SCREEN DRAWINGS
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

local ScreenDrawings = {}

local function InitScreenDrawings()
    ScreenDrawings.FOV = Drawing.new("Circle")
    ScreenDrawings.FOV.Thickness = 1.5
    ScreenDrawings.FOV.NumSides = 64
    ScreenDrawings.FOV.Filled = false
    
    ScreenDrawings.CrosshairTop = Drawing.new("Line")
    ScreenDrawings.CrosshairTop.Thickness = 1.5
    ScreenDrawings.CrosshairBottom = Drawing.new("Line")
    ScreenDrawings.CrosshairBottom.Thickness = 1.5
    ScreenDrawings.CrosshairLeft = Drawing.new("Line")
    ScreenDrawings.CrosshairLeft.Thickness = 1.5
    ScreenDrawings.CrosshairRight = Drawing.new("Line")
    ScreenDrawings.CrosshairRight.Thickness = 1.5
    ScreenDrawings.CrosshairDot = Drawing.new("Circle")
    ScreenDrawings.CrosshairDot.Filled = true
    ScreenDrawings.CrosshairDot.NumSides = 12
    ScreenDrawings.CrosshairDot.Radius = 2
    
    ScreenDrawings.Snapline = Drawing.new("Line")
    ScreenDrawings.Snapline.Thickness = 1.5
    
    ScreenDrawings.TargetInfo = Drawing.new("Text")
    ScreenDrawings.TargetInfo.Size = 14
    ScreenDrawings.TargetInfo.Center = true
    ScreenDrawings.TargetInfo.Outline = true
    ScreenDrawings.TargetInfo.Font = Drawing.Fonts.Plex
    
    ScreenDrawings.Watermark = Drawing.new("Text")
    ScreenDrawings.Watermark.Size = 14
    ScreenDrawings.Watermark.Outline = true
    ScreenDrawings.Watermark.Font = Drawing.Fonts.Plex
    ScreenDrawings.Watermark.Position = Vector2.new(10, 10)
    ScreenDrawings.Watermark.Color = Color3.fromRGB(255, 85, 255)
    
    ScreenDrawings.FPS = Drawing.new("Text")
    ScreenDrawings.FPS.Size = 13
    ScreenDrawings.FPS.Outline = true
    ScreenDrawings.FPS.Font = Drawing.Fonts.Plex
    ScreenDrawings.FPS.Color = Color3.fromRGB(0, 255, 128)
    
    ScreenDrawings.Ping = Drawing.new("Text")
    ScreenDrawings.Ping.Size = 13
    ScreenDrawings.Ping.Outline = true
    ScreenDrawings.Ping.Font = Drawing.Fonts.Plex
    ScreenDrawings.Ping.Color = Color3.fromRGB(255, 200, 100)
    
    ScreenDrawings.PlayerCount = Drawing.new("Text")
    ScreenDrawings.PlayerCount.Size = 13
    ScreenDrawings.PlayerCount.Outline = true
    ScreenDrawings.PlayerCount.Font = Drawing.Fonts.Plex
    ScreenDrawings.PlayerCount.Color = Color3.fromRGB(100, 200, 255)
    
    ScreenDrawings.HitMarker = {}
    for i = 1, 4 do
        ScreenDrawings.HitMarker[i] = Drawing.new("Line")
        ScreenDrawings.HitMarker[i].Thickness = 2
    end
    
    ScreenDrawings.KeybindBG = Drawing.new("Square")
    ScreenDrawings.KeybindBG.Filled = true
    ScreenDrawings.KeybindBG.Color = Color3.fromRGB(20, 20, 28)
    
    ScreenDrawings.KeybindTitle = Drawing.new("Text")
    ScreenDrawings.KeybindTitle.Size = 12
    ScreenDrawings.KeybindTitle.Outline = true
    ScreenDrawings.KeybindTitle.Font = Drawing.Fonts.Plex
    ScreenDrawings.KeybindTitle.Color = Color3.fromRGB(255, 85, 255)
    
    ScreenDrawings.KeybindList = {}
    for i = 1, 5 do
        ScreenDrawings.KeybindList[i] = Drawing.new("Text")
        ScreenDrawings.KeybindList[i].Size = 11
        ScreenDrawings.KeybindList[i].Outline = true
        ScreenDrawings.KeybindList[i].Font = Drawing.Fonts.Plex
        ScreenDrawings.KeybindList[i].Color = Color3.fromRGB(200, 200, 200)
    end
    
    ScreenDrawings.SpecBG = Drawing.new("Square")
    ScreenDrawings.SpecBG.Filled = true
    ScreenDrawings.SpecBG.Color = Color3.fromRGB(20, 20, 28)
    
    ScreenDrawings.SpecTitle = Drawing.new("Text")
    ScreenDrawings.SpecTitle.Size = 12
    ScreenDrawings.SpecTitle.Outline = true
    ScreenDrawings.SpecTitle.Font = Drawing.Fonts.Plex
    ScreenDrawings.SpecTitle.Color = Color3.fromRGB(255, 85, 255)
    
    ScreenDrawings.SpecList = {}
    for i = 1, 5 do
        ScreenDrawings.SpecList[i] = Drawing.new("Text")
        ScreenDrawings.SpecList[i].Size = 11
        ScreenDrawings.SpecList[i].Outline = true
        ScreenDrawings.SpecList[i].Font = Drawing.Fonts.Plex
        ScreenDrawings.SpecList[i].Color = Color3.fromRGB(255, 100, 100)
    end
end

local function UpdateScreenDrawings()
    if State.PanicMode then
        for k, v in pairs(ScreenDrawings) do
            if type(v) == "table" then
                for _, d in pairs(v) do pcall(function() d.Visible = false end) end
            else
                pcall(function() v.Visible = false end)
            end
        end
        return
    end
    
    local center = GetCenter()
    local viewport = Camera.ViewportSize
    
    -- FOV Circle
    if Config.Screen.FOVCircle and Config.Aimbot.Enabled then
        ScreenDrawings.FOV.Position = center
        ScreenDrawings.FOV.Radius = Config.Aimbot.FOV
        ScreenDrawings.FOV.Color = Config.Screen.FOVColor
        ScreenDrawings.FOV.Visible = true
    else
        ScreenDrawings.FOV.Visible = false
    end
    
    -- Crosshair
    if Config.Screen.Crosshair then
        local size = Config.Screen.CrosshairSize
        local gap = Config.Screen.CrosshairGap
        local color = Config.Screen.CrosshairColor
        
        ScreenDrawings.CrosshairTop.From = Vector2.new(center.X, center.Y - gap - size)
        ScreenDrawings.CrosshairTop.To = Vector2.new(center.X, center.Y - gap)
        ScreenDrawings.CrosshairTop.Color = color
        ScreenDrawings.CrosshairTop.Visible = true
        
        ScreenDrawings.CrosshairBottom.From = Vector2.new(center.X, center.Y + gap)
        ScreenDrawings.CrosshairBottom.To = Vector2.new(center.X, center.Y + gap + size)
        ScreenDrawings.CrosshairBottom.Color = color
        ScreenDrawings.CrosshairBottom.Visible = true
        
        ScreenDrawings.CrosshairLeft.From = Vector2.new(center.X - gap - size, center.Y)
        ScreenDrawings.CrosshairLeft.To = Vector2.new(center.X - gap, center.Y)
        ScreenDrawings.CrosshairLeft.Color = color
        ScreenDrawings.CrosshairLeft.Visible = true
        
        ScreenDrawings.CrosshairRight.From = Vector2.new(center.X + gap, center.Y)
        ScreenDrawings.CrosshairRight.To = Vector2.new(center.X + gap + size, center.Y)
        ScreenDrawings.CrosshairRight.Color = color
        ScreenDrawings.CrosshairRight.Visible = true
        
        if Config.Screen.CrosshairDot then
            ScreenDrawings.CrosshairDot.Position = center
            ScreenDrawings.CrosshairDot.Color = color
            ScreenDrawings.CrosshairDot.Visible = true
        else
            ScreenDrawings.CrosshairDot.Visible = false
        end
    else
        ScreenDrawings.CrosshairTop.Visible = false
        ScreenDrawings.CrosshairBottom.Visible = false
        ScreenDrawings.CrosshairLeft.Visible = false
        ScreenDrawings.CrosshairRight.Visible = false
        ScreenDrawings.CrosshairDot.Visible = false
    end
    
    -- Snapline
    if Config.Screen.TargetSnapline and State.AimTarget and State.IsAiming then
        local char = State.AimTarget.Character
        if char then
            local head = char:FindFirstChild("Head")
            if head then
                local screen, onScreen = WorldToScreen(head.Position)
                if onScreen then
                    ScreenDrawings.Snapline.From = center
                    ScreenDrawings.Snapline.To = screen
                    ScreenDrawings.Snapline.Color = Config.Screen.SnaplineColor
                    ScreenDrawings.Snapline.Visible = true
                else
                    ScreenDrawings.Snapline.Visible = false
                end
            else
                ScreenDrawings.Snapline.Visible = false
            end
        else
            ScreenDrawings.Snapline.Visible = false
        end
    else
        ScreenDrawings.Snapline.Visible = false
    end
    
    -- Target Info
    if Config.Screen.TargetInfo and State.AimTarget and State.IsAiming then
        local char = State.AimTarget.Character
        if char then
            local hum = char:FindFirstChildOfClass("Humanoid")
            local head = char:FindFirstChild("Head")
            if hum and head then
                local hp = math.floor(hum.Health)
                local dist = math.floor(GetDistance(head.Position))
                ScreenDrawings.TargetInfo.Text = string.format("Target: %s | HP: %d | Dist: %dm", State.AimTarget.Name, hp, dist)
                ScreenDrawings.TargetInfo.Position = Vector2.new(center.X, center.Y + 50)
                ScreenDrawings.TargetInfo.Color = Color3.fromRGB(255, 50, 50)
                ScreenDrawings.TargetInfo.Visible = true
            else
                ScreenDrawings.TargetInfo.Visible = false
            end
        else
            ScreenDrawings.TargetInfo.Visible = false
        end
    else
        ScreenDrawings.TargetInfo.Visible = false
    end
    
    -- Watermark
    if Config.Screen.Watermark then
        ScreenDrawings.Watermark.Text = string.format("ULTIMATE CHEAT | %s", os.date("%H:%M:%S"))
        ScreenDrawings.Watermark.Visible = true
    else
        ScreenDrawings.Watermark.Visible = false
    end
    
    -- FPS
    State.FrameCount = State.FrameCount + 1
    local now = tick()
    if now - State.LastFPSUpdate >= 1 then
        State.FPS = State.FrameCount
        State.FrameCount = 0
        State.LastFPSUpdate = now
    end
    
    if Config.Screen.FPS then
        ScreenDrawings.FPS.Text = string.format("FPS: %d", State.FPS)
        ScreenDrawings.FPS.Position = Vector2.new(10, 30)
        ScreenDrawings.FPS.Visible = true
    else
        ScreenDrawings.FPS.Visible = false
    end
    
    -- Ping
    if Config.Screen.Ping then
        local ping = 0
        pcall(function()
            ping = math.floor(Stats.Network.ServerStatsItem["Data Ping"]:GetValue())
        end)
        ScreenDrawings.Ping.Text = string.format("Ping: %dms", ping)
        ScreenDrawings.Ping.Position = Vector2.new(10, 45)
        ScreenDrawings.Ping.Visible = true
    else
        ScreenDrawings.Ping.Visible = false
    end
    
    -- Player Count
    if Config.Screen.PlayerCount then
        ScreenDrawings.PlayerCount.Text = string.format("Players: %d", #Players:GetPlayers())
        ScreenDrawings.PlayerCount.Position = Vector2.new(10, 60)
        ScreenDrawings.PlayerCount.Visible = true
    else
        ScreenDrawings.PlayerCount.Visible = false
    end
    
    -- Hit Marker
    if Config.Screen.HitMarker and tick() - State.HitMarkerTime < 0.15 then
        local size = 8
        local gap = 4
        
        ScreenDrawings.HitMarker[1].From = Vector2.new(center.X - gap - size, center.Y - gap - size)
        ScreenDrawings.HitMarker[1].To = Vector2.new(center.X - gap, center.Y - gap)
        ScreenDrawings.HitMarker[2].From = Vector2.new(center.X + gap + size, center.Y - gap - size)
        ScreenDrawings.HitMarker[2].To = Vector2.new(center.X + gap, center.Y - gap)
        ScreenDrawings.HitMarker[3].From = Vector2.new(center.X - gap - size, center.Y + gap + size)
        ScreenDrawings.HitMarker[3].To = Vector2.new(center.X - gap, center.Y + gap)
        ScreenDrawings.HitMarker[4].From = Vector2.new(center.X + gap + size, center.Y + gap + size)
        ScreenDrawings.HitMarker[4].To = Vector2.new(center.X + gap, center.Y + gap)
        
        for i = 1, 4 do
            ScreenDrawings.HitMarker[i].Color = Config.Screen.HitMarkerColor
            ScreenDrawings.HitMarker[i].Visible = true
        end
    else
        for i = 1, 4 do
            ScreenDrawings.HitMarker[i].Visible = false
        end
    end
    
    -- Keybind List
    if Config.Screen.KeybindList then
        local x = viewport.X - 150
        local y = 100
        
        ScreenDrawings.KeybindBG.Position = Vector2.new(x - 5, y - 5)
        ScreenDrawings.KeybindBG.Size = Vector2.new(140, 85)
        ScreenDrawings.KeybindBG.Transparency = 0.3
        ScreenDrawings.KeybindBG.Visible = true
        
        ScreenDrawings.KeybindTitle.Text = "Active Features"
        ScreenDrawings.KeybindTitle.Position = Vector2.new(x, y)
        ScreenDrawings.KeybindTitle.Visible = true
        
        local features = {}
        if Config.Aimbot.Enabled then table.insert(features, "Aimbot [RMB]") end
        if Config.Triggerbot.Enabled then table.insert(features, "Triggerbot") end
        if Config.ESP.Enabled then table.insert(features, "ESP") end
        if Config.ESP.Skeleton then table.insert(features, "Skeleton") end
        if Config.Screen.Crosshair then table.insert(features, "Crosshair") end
        
        for i = 1, 5 do
            if features[i] then
                ScreenDrawings.KeybindList[i].Text = "â€¢ " .. features[i]
                ScreenDrawings.KeybindList[i].Position = Vector2.new(x, y + 15 + (i-1) * 13)
                ScreenDrawings.KeybindList[i].Visible = true
            else
                ScreenDrawings.KeybindList[i].Visible = false
            end
        end
    else
        ScreenDrawings.KeybindBG.Visible = false
        ScreenDrawings.KeybindTitle.Visible = false
        for i = 1, 5 do ScreenDrawings.KeybindList[i].Visible = false end
    end
    
    -- Spectator List
    if Config.Screen.SpectatorList then
        local x = viewport.X - 150
        local y = 200
        
        local spectators = {}
        for _, player in pairs(Players:GetPlayers()) do
            if player ~= LocalPlayer then
                local char = player.Character
                if char then
                    local hum = char:FindFirstChildOfClass("Humanoid")
                    if hum and hum.Health <= 0 then
                        table.insert(spectators, player.Name)
                    end
                end
            end
        end
        
        if #spectators > 0 then
            ScreenDrawings.SpecBG.Position = Vector2.new(x - 5, y - 5)
            ScreenDrawings.SpecBG.Size = Vector2.new(140, 20 + #spectators * 13)
            ScreenDrawings.SpecBG.Transparency = 0.3
            ScreenDrawings.SpecBG.Visible = true
            
            ScreenDrawings.SpecTitle.Text = "Spectators"
            ScreenDrawings.SpecTitle.Position = Vector2.new(x, y)
            ScreenDrawings.SpecTitle.Visible = true
            
            for i = 1, 5 do
                if spectators[i] then
                    ScreenDrawings.SpecList[i].Text = "â€¢ " .. spectators[i]
                    ScreenDrawings.SpecList[i].Position = Vector2.new(x, y + 15 + (i-1) * 13)
                    ScreenDrawings.SpecList[i].Visible = true
                else
                    ScreenDrawings.SpecList[i].Visible = false
                end
            end
        else
            ScreenDrawings.SpecBG.Visible = false
            ScreenDrawings.SpecTitle.Visible = false
            for i = 1, 5 do ScreenDrawings.SpecList[i].Visible = false end
        end
    else
        ScreenDrawings.SpecBG.Visible = false
        ScreenDrawings.SpecTitle.Visible = false
        for i = 1, 5 do ScreenDrawings.SpecList[i].Visible = false end
    end
end

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- WORLD VISUALS (FOV, Fullbright) - SEPARATE FROM ESP
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

local Lighting = game:GetService("Lighting")

-- Store original values ONCE at start
local OriginalFOV = 70
local OriginalAmbient = Lighting.Ambient
local OriginalBrightness = Lighting.Brightness
local OriginalOutdoorAmbient = Lighting.OutdoorAmbient
local OriginalGlobalShadows = Lighting.GlobalShadows
local OriginalFogEnd = Lighting.FogEnd
local OriginalClockTime = Lighting.ClockTime

local FullbrightActive = false
local FogRemoved = false

local function SetFullbright(enabled)
    if enabled and not FullbrightActive then
        Lighting.Ambient = Color3.new(1, 1, 1)
        Lighting.Brightness = 2
        Lighting.OutdoorAmbient = Color3.new(1, 1, 1)
        Lighting.GlobalShadows = false
        
        for _, v in pairs(Lighting:GetDescendants()) do
            if v:IsA("Atmosphere") then
                v.Density = 0
            elseif v:IsA("BloomEffect") or v:IsA("BlurEffect") or v:IsA("ColorCorrectionEffect") or v:IsA("SunRaysEffect") or v:IsA("DepthOfFieldEffect") then
                v.Enabled = false
            end
        end
        
        FullbrightActive = true
    elseif not enabled and FullbrightActive then
        Lighting.Ambient = OriginalAmbient
        Lighting.Brightness = OriginalBrightness
        Lighting.OutdoorAmbient = OriginalOutdoorAmbient
        Lighting.GlobalShadows = OriginalGlobalShadows
        
        for _, v in pairs(Lighting:GetDescendants()) do
            if v:IsA("Atmosphere") then
                v.Density = 0.3
            elseif v:IsA("BloomEffect") or v:IsA("BlurEffect") or v:IsA("ColorCorrectionEffect") or v:IsA("SunRaysEffect") or v:IsA("DepthOfFieldEffect") then
                v.Enabled = true
            end
        end
        
        FullbrightActive = false
    end
end

local function SetNoFog(enabled)
    if enabled and not FogRemoved then
        Lighting.FogEnd = 9e9
        Lighting.FogStart = 9e9
        FogRemoved = true
    elseif not enabled and FogRemoved then
        Lighting.FogEnd = OriginalFogEnd
        Lighting.FogStart = 0
        FogRemoved = false
    end
end

local function UpdateWorld()
    -- FOV - only touch camera FOV, nothing else
    if Config.World.FOVChanger then
        Camera.FieldOfView = Config.World.FOVValue
    else
        Camera.FieldOfView = OriginalFOV
    end
    
    -- Fullbright
    SetFullbright(Config.World.Fullbright)
    
    -- No Fog
    SetNoFog(Config.World.NoFog)
    
    -- Custom Time
    if Config.World.CustomTime then
        Lighting.ClockTime = Config.World.TimeValue
    end
end

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- AIMBOT
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

local function GetAimTarget()
    if not Config.Aimbot.Enabled then return nil end
    
    local closest = nil
    local closestDist = Config.Aimbot.FOV
    local center = GetCenter()
    local myChar = LocalPlayer.Character
    if not myChar then return nil end
    
    local myHead = myChar:FindFirstChild("Head")
    local myRoot = myChar:FindFirstChild("HumanoidRootPart")
    local origin = myHead and myHead.Position or (myRoot and myRoot.Position) or Camera.CFrame.Position
    
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer then
            local isTeam = false
            if Config.Aimbot.TeamCheck then
                isTeam = IsTeammate(player)
            end
            
            if not isTeam then
                local char = player.Character
                if char then
                    local humanoid = char:FindFirstChildOfClass("Humanoid")
                    local targetPart = char:FindFirstChild(Config.Aimbot.TargetPart) 
                                    or char:FindFirstChild("Head")
                                    or char:FindFirstChild("HumanoidRootPart")
                    
                    if humanoid and humanoid.Health > 0 and targetPart then
                        local worldDist = (origin - targetPart.Position).Magnitude
                        
                        if worldDist <= Config.Aimbot.MaxDistance then
                            local screen, onScreen = WorldToScreen(targetPart.Position)
                            
                            if onScreen then
                                local screenDist = (screen - center).Magnitude
                                
                                if screenDist < closestDist then
                                    local canSee = true
                                    if Config.Aimbot.VisCheck then
                                        canSee = IsVisible(origin, targetPart.Position, myChar)
                                    end
                                    
                                    if canSee then
                                        closestDist = screenDist
                                        closest = player
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
    end
    
    return closest
end

local function AimAt(player)
    if not player then return end
    
    local char = player.Character
    if not char then return end
    
    local targetPart = char:FindFirstChild(Config.Aimbot.TargetPart) 
                    or char:FindFirstChild("Head")
                    or char:FindFirstChild("HumanoidRootPart")
    if not targetPart then return end
    
    -- Get target position with prediction
    local targetPos = targetPart.Position
    if Config.Aimbot.Prediction > 0 then
        local vel = Vector3.zero
        pcall(function()
            vel = targetPart.AssemblyLinearVelocity or Vector3.zero
        end)
        pcall(function()
            if vel.Magnitude < 1 then
                vel = targetPart.Velocity or Vector3.zero
            end
        end)
        targetPos = targetPos + (vel * Config.Aimbot.Prediction)
    end
    
    local screen, onScreen = WorldToScreen(targetPos)
    if not onScreen then return end
    
    local center = GetCenter()
    local deltaX = screen.X - center.X
    local deltaY = screen.Y - center.Y
    
    -- Apply smoothing
    local smooth = math.max(Config.Aimbot.Smoothing, 1)
    local moveX = deltaX / smooth
    local moveY = deltaY / smooth
    
    -- Move mouse
    mousemoverel(moveX, moveY)
end

local function UpdateAimbot()
    if State.PanicMode then
        State.AimTarget = nil
        return
    end
    
    if not Config.Aimbot.Enabled then
        State.AimTarget = nil
        return
    end
    
    if not State.IsAiming then
        State.AimTarget = nil
        return
    end
    
    -- Get or keep target
    if Config.Aimbot.TargetLock and State.AimTarget then
        -- Check if current target is still valid
        local char = State.AimTarget.Character
        if char then
            local hum = char:FindFirstChildOfClass("Humanoid")
            if hum and hum.Health > 0 then
                AimAt(State.AimTarget)
                return
            end
        end
        -- Target invalid, get new one
        State.AimTarget = GetAimTarget()
        AimAt(State.AimTarget)
    else
        -- Always get closest target
        State.AimTarget = GetAimTarget()
        AimAt(State.AimTarget)
    end
end

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- TRIGGERBOT
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

local function UpdateTriggerbot()
    if not Config.Triggerbot.Enabled or State.PanicMode then return end
    
    local now = tick()
    if now - State.LastTriggerFire < Config.Triggerbot.Delay then return end
    
    local char = LocalPlayer.Character
    if not char then return end
    
    local origin = Camera.CFrame.Position
    local direction = Camera.CFrame.LookVector * 1000
    
    local params = RaycastParams.new()
    params.FilterType = Enum.RaycastFilterType.Exclude
    params.FilterDescendantsInstances = {char}
    
    local result = Workspace:Raycast(origin, direction, params)
    
    if result and result.Instance then
        local hitChar = result.Instance:FindFirstAncestorOfClass("Model")
        if hitChar then
            local hitPlayer = Players:GetPlayerFromCharacter(hitChar)
            if hitPlayer and hitPlayer ~= LocalPlayer then
                if not Config.Triggerbot.TeamCheck or not IsTeammate(hitPlayer) then
                    local hum = hitChar:FindFirstChildOfClass("Humanoid")
                    if hum and hum.Health > 0 then
                        if Config.Triggerbot.BurstMode then
                            for i = 1, Config.Triggerbot.BurstCount do
                                mouse1click()
                                if i < Config.Triggerbot.BurstCount then
                                    task.wait(Config.Triggerbot.BurstDelay)
                                end
                            end
                        else
                            mouse1click()
                        end
                        
                        State.LastTriggerFire = now
                        State.HitMarkerTime = now
                    end
                end
            end
        end
    end
end

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- GUI
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

local GUI = {}

function GUI:Create()
    self.ScreenGui = Instance.new("ScreenGui")
    self.ScreenGui.Name = "UltimateCheat"
    self.ScreenGui.ResetOnSpawn = false
    
    pcall(function() self.ScreenGui.Parent = CoreGui end)
    if not self.ScreenGui.Parent then
        self.ScreenGui.Parent = LocalPlayer.PlayerGui
    end
    
    self.Main = Instance.new("Frame", self.ScreenGui)
    self.Main.Size = UDim2.new(0, 520, 0, 400)
    self.Main.Position = UDim2.new(0.5, -260, 0.5, -200)
    self.Main.BackgroundColor3 = Color3.fromRGB(15, 15, 20)
    self.Main.BorderSizePixel = 0
    
    Instance.new("UICorner", self.Main).CornerRadius = UDim.new(0, 10)
    
    local stroke = Instance.new("UIStroke", self.Main)
    stroke.Color = Color3.fromRGB(255, 85, 255)
    stroke.Thickness = 2
    
    local titleBar = Instance.new("Frame", self.Main)
    titleBar.Size = UDim2.new(1, 0, 0, 35)
    titleBar.BackgroundColor3 = Color3.fromRGB(20, 20, 28)
    titleBar.BorderSizePixel = 0
    Instance.new("UICorner", titleBar).CornerRadius = UDim.new(0, 10)
    
    local title = Instance.new("TextLabel", titleBar)
    title.Size = UDim2.new(1, -10, 1, 0)
    title.Position = UDim2.new(0, 10, 0, 0)
    title.BackgroundTransparency = 1
    title.Text = "ğŸ¯ ULTIMATE CHEAT v5.4"
    title.TextColor3 = Color3.new(1, 1, 1)
    title.TextSize = 15
    title.Font = Enum.Font.GothamBold
    title.TextXAlignment = Enum.TextXAlignment.Left
    
    local tabContainer = Instance.new("Frame", self.Main)
    tabContainer.Size = UDim2.new(1, -16, 0, 28)
    tabContainer.Position = UDim2.new(0, 8, 0, 40)
    tabContainer.BackgroundTransparency = 1
    
    local tabLayout = Instance.new("UIListLayout", tabContainer)
    tabLayout.FillDirection = Enum.FillDirection.Horizontal
    tabLayout.Padding = UDim.new(0, 4)
    
    local contentArea = Instance.new("Frame", self.Main)
    contentArea.Name = "Content"
    contentArea.Size = UDim2.new(1, -16, 1, -85)
    contentArea.Position = UDim2.new(0, 8, 0, 72)
    contentArea.BackgroundTransparency = 1
    
    local pages = {}
    local tabButtons = {}
    local tabs = {"Aimbot", "Triggerbot", "ESP", "Visuals", "World", "Settings"}
    
    for i, tabName in ipairs(tabs) do
        local tabBtn = Instance.new("TextButton", tabContainer)
        tabBtn.Size = UDim2.new(0, 70, 1, 0)
        tabBtn.BackgroundColor3 = i == 1 and Color3.fromRGB(255, 85, 255) or Color3.fromRGB(30, 30, 40)
        tabBtn.BorderSizePixel = 0
        tabBtn.Text = tabName
        tabBtn.TextColor3 = Color3.new(1, 1, 1)
        tabBtn.TextSize = 11
        tabBtn.Font = Enum.Font.GothamBold
        Instance.new("UICorner", tabBtn).CornerRadius = UDim.new(0, 6)
        
        tabButtons[tabName] = tabBtn
        
        local page = Instance.new("ScrollingFrame", contentArea)
        page.Name = tabName
        page.Size = UDim2.new(1, 0, 1, 0)
        page.BackgroundTransparency = 1
        page.BorderSizePixel = 0
        page.ScrollBarThickness = 3
        page.ScrollBarImageColor3 = Color3.fromRGB(255, 85, 255)
        page.CanvasSize = UDim2.new(0, 0, 0, 0)
        page.AutomaticCanvasSize = Enum.AutomaticSize.Y
        page.Visible = i == 1
        
        Instance.new("UIListLayout", page).Padding = UDim.new(0, 4)
        
        pages[tabName] = page
        
        tabBtn.MouseButton1Click:Connect(function()
            for name, btn in pairs(tabButtons) do
                btn.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
            end
            tabBtn.BackgroundColor3 = Color3.fromRGB(255, 85, 255)
            
            for name, p in pairs(pages) do
                p.Visible = name == tabName
            end
        end)
    end
    
    local function Section(parent, name)
        local s = Instance.new("TextLabel", parent)
        s.Size = UDim2.new(1, 0, 0, 20)
        s.BackgroundTransparency = 1
        s.Text = "  " .. name:upper()
        s.TextColor3 = Color3.fromRGB(255, 85, 255)
        s.TextSize = 10
        s.Font = Enum.Font.GothamBold
        s.TextXAlignment = Enum.TextXAlignment.Left
    end
    
    local function Toggle(parent, name, tbl, key)
        local frame = Instance.new("Frame", parent)
        frame.Size = UDim2.new(1, 0, 0, 26)
        frame.BackgroundColor3 = Color3.fromRGB(25, 25, 32)
        frame.BorderSizePixel = 0
        Instance.new("UICorner", frame).CornerRadius = UDim.new(0, 5)
        
        local label = Instance.new("TextLabel", frame)
        label.Size = UDim2.new(1, -50, 1, 0)
        label.Position = UDim2.new(0, 8, 0, 0)
        label.BackgroundTransparency = 1
        label.Text = name
        label.TextColor3 = Color3.fromRGB(200, 200, 200)
        label.TextSize = 11
        label.Font = Enum.Font.Gotham
        label.TextXAlignment = Enum.TextXAlignment.Left
        
        local toggle = Instance.new("Frame", frame)
        toggle.Size = UDim2.new(0, 32, 0, 16)
        toggle.Position = UDim2.new(1, -40, 0.5, -8)
        toggle.BackgroundColor3 = tbl[key] and Color3.fromRGB(255, 85, 255) or Color3.fromRGB(45, 45, 55)
        toggle.BorderSizePixel = 0
        Instance.new("UICorner", toggle).CornerRadius = UDim.new(1, 0)
        
        local circle = Instance.new("Frame", toggle)
        circle.Size = UDim2.new(0, 12, 0, 12)
        circle.Position = tbl[key] and UDim2.new(1, -14, 0.5, -6) or UDim2.new(0, 2, 0.5, -6)
        circle.BackgroundColor3 = Color3.new(1, 1, 1)
        circle.BorderSizePixel = 0
        Instance.new("UICorner", circle).CornerRadius = UDim.new(1, 0)
        
        local btn = Instance.new("TextButton", frame)
        btn.Size = UDim2.new(1, 0, 1, 0)
        btn.BackgroundTransparency = 1
        btn.Text = ""
        btn.MouseButton1Click:Connect(function()
            tbl[key] = not tbl[key]
            TweenService:Create(circle, TweenInfo.new(0.1), {
                Position = tbl[key] and UDim2.new(1, -14, 0.5, -6) or UDim2.new(0, 2, 0.5, -6)
            }):Play()
            TweenService:Create(toggle, TweenInfo.new(0.1), {
                BackgroundColor3 = tbl[key] and Color3.fromRGB(255, 85, 255) or Color3.fromRGB(45, 45, 55)
            }):Play()
        end)
    end
    
    local function Slider(parent, name, tbl, key, min, max, dec)
        local frame = Instance.new("Frame", parent)
        frame.Size = UDim2.new(1, 0, 0, 34)
        frame.BackgroundColor3 = Color3.fromRGB(25, 25, 32)
        frame.BorderSizePixel = 0
        Instance.new("UICorner", frame).CornerRadius = UDim.new(0, 5)
        
        local label = Instance.new("TextLabel", frame)
        label.Size = UDim2.new(1, -45, 0, 14)
        label.Position = UDim2.new(0, 8, 0, 2)
        label.BackgroundTransparency = 1
        label.Text = name
        label.TextColor3 = Color3.fromRGB(180, 180, 180)
        label.TextSize = 10
        label.Font = Enum.Font.Gotham
        label.TextXAlignment = Enum.TextXAlignment.Left
        
        local value = Instance.new("TextLabel", frame)
        value.Size = UDim2.new(0, 40, 0, 14)
        value.Position = UDim2.new(1, -45, 0, 2)
        value.BackgroundTransparency = 1
        value.Text = dec and string.format("%.2f", tbl[key]) or tostring(tbl[key])
        value.TextColor3 = Color3.fromRGB(255, 85, 255)
        value.TextSize = 10
        value.Font = Enum.Font.GothamBold
        value.TextXAlignment = Enum.TextXAlignment.Right
        
        local bg = Instance.new("Frame", frame)
        bg.Size = UDim2.new(1, -16, 0, 4)
        bg.Position = UDim2.new(0, 8, 0, 22)
        bg.BackgroundColor3 = Color3.fromRGB(45, 45, 55)
        bg.BorderSizePixel = 0
        Instance.new("UICorner", bg).CornerRadius = UDim.new(1, 0)
        
        local fill = Instance.new("Frame", bg)
        fill.Size = UDim2.new((tbl[key] - min) / (max - min), 0, 1, 0)
        fill.BackgroundColor3 = Color3.fromRGB(255, 85, 255)
        fill.BorderSizePixel = 0
        Instance.new("UICorner", fill).CornerRadius = UDim.new(1, 0)
        
        local dragging = false
        bg.InputBegan:Connect(function(i)
            if i.UserInputType == Enum.UserInputType.MouseButton1 then dragging = true end
        end)
        UserInputService.InputEnded:Connect(function(i)
            if i.UserInputType == Enum.UserInputType.MouseButton1 then dragging = false end
        end)
        UserInputService.InputChanged:Connect(function(i)
            if dragging and i.UserInputType == Enum.UserInputType.MouseMovement then
                local p = math.clamp((i.Position.X - bg.AbsolutePosition.X) / bg.AbsoluteSize.X, 0, 1)
                tbl[key] = dec and (min + (max - min) * p) or math.floor(min + (max - min) * p)
                value.Text = dec and string.format("%.2f", tbl[key]) or tostring(tbl[key])
                fill.Size = UDim2.new(p, 0, 1, 0)
            end
        end)
    end
    
    local function Dropdown(parent, name, tbl, key, options)
        local frame = Instance.new("Frame", parent)
        frame.Size = UDim2.new(1, 0, 0, 26)
        frame.BackgroundColor3 = Color3.fromRGB(25, 25, 32)
        frame.BorderSizePixel = 0
        frame.ClipsDescendants = false
        Instance.new("UICorner", frame).CornerRadius = UDim.new(0, 5)
        
        local label = Instance.new("TextLabel", frame)
        label.Size = UDim2.new(0.5, 0, 1, 0)
        label.Position = UDim2.new(0, 8, 0, 0)
        label.BackgroundTransparency = 1
        label.Text = name
        label.TextColor3 = Color3.fromRGB(180, 180, 180)
        label.TextSize = 11
        label.Font = Enum.Font.Gotham
        label.TextXAlignment = Enum.TextXAlignment.Left
        
        local btn = Instance.new("TextButton", frame)
        btn.Size = UDim2.new(0, 100, 0, 20)
        btn.Position = UDim2.new(1, -108, 0.5, -10)
        btn.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
        btn.BorderSizePixel = 0
        btn.Text = tostring(tbl[key])
        btn.TextColor3 = Color3.fromRGB(255, 85, 255)
        btn.TextSize = 10
        btn.Font = Enum.Font.GothamBold
        Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 4)
        
        local list = Instance.new("Frame", frame)
        list.Size = UDim2.new(0, 100, 0, #options * 20)
        list.Position = UDim2.new(1, -108, 1, 2)
        list.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
        list.BorderSizePixel = 0
        list.Visible = false
        list.ZIndex = 10
        Instance.new("UICorner", list).CornerRadius = UDim.new(0, 4)
        
        for i, opt in ipairs(options) do
            local optBtn = Instance.new("TextButton", list)
            optBtn.Size = UDim2.new(1, 0, 0, 20)
            optBtn.Position = UDim2.new(0, 0, 0, (i-1)*20)
            optBtn.BackgroundTransparency = 1
            optBtn.Text = tostring(opt)
            optBtn.TextColor3 = Color3.fromRGB(170, 170, 170)
            optBtn.TextSize = 10
            optBtn.Font = Enum.Font.Gotham
            optBtn.ZIndex = 11
            optBtn.MouseButton1Click:Connect(function()
                tbl[key] = opt
                btn.Text = tostring(opt)
                list.Visible = false
            end)
        end
        
        btn.MouseButton1Click:Connect(function()
            list.Visible = not list.Visible
        end)
    end
    
    -- BUILD TABS
    Section(pages.Aimbot, "Main")
    Toggle(pages.Aimbot, "Enabled", Config.Aimbot, "Enabled")
    Toggle(pages.Aimbot, "Team Check", Config.Aimbot, "TeamCheck")
    Toggle(pages.Aimbot, "Visibility Check", Config.Aimbot, "VisCheck")
    Toggle(pages.Aimbot, "Target Lock", Config.Aimbot, "TargetLock")
    Section(pages.Aimbot, "Settings")
    Dropdown(pages.Aimbot, "Target Part", Config.Aimbot, "TargetPart", {"Head", "UpperTorso", "HumanoidRootPart"})
    Slider(pages.Aimbot, "FOV", Config.Aimbot, "FOV", 30, 500)
    Slider(pages.Aimbot, "Smoothing", Config.Aimbot, "Smoothing", 1, 20)
    Slider(pages.Aimbot, "Prediction", Config.Aimbot, "Prediction", 0, 0.3, true)
    Slider(pages.Aimbot, "Max Distance", Config.Aimbot, "MaxDistance", 100, 2000)
    
    Section(pages.Triggerbot, "Main")
    Toggle(pages.Triggerbot, "Enabled", Config.Triggerbot, "Enabled")
    Toggle(pages.Triggerbot, "Team Check", Config.Triggerbot, "TeamCheck")
    Section(pages.Triggerbot, "Settings")
    Slider(pages.Triggerbot, "Delay", Config.Triggerbot, "Delay", 0.01, 0.2, true)
    Toggle(pages.Triggerbot, "Burst Mode", Config.Triggerbot, "BurstMode")
    Slider(pages.Triggerbot, "Burst Count", Config.Triggerbot, "BurstCount", 2, 5)
    
    Section(pages.ESP, "Main")
    Toggle(pages.ESP, "Enabled", Config.ESP, "Enabled")
    Toggle(pages.ESP, "Team Check", Config.ESP, "TeamCheck")
    Slider(pages.ESP, "Max Distance", Config.ESP, "MaxDistance", 100, 3000)
    Section(pages.ESP, "Box")
    Toggle(pages.ESP, "Box", Config.ESP, "Box")
    Dropdown(pages.ESP, "Box Type", Config.ESP, "BoxType", {"Full", "Corner"})
    Toggle(pages.ESP, "Box Outline", Config.ESP, "BoxOutline")
    Toggle(pages.ESP, "Fill Box", Config.ESP, "FillBox")
    Section(pages.ESP, "Info")
    Toggle(pages.ESP, "Name", Config.ESP, "Name")
    Toggle(pages.ESP, "Health Bar", Config.ESP, "HealthBar")
    Toggle(pages.ESP, "Health Text", Config.ESP, "HealthText")
    Toggle(pages.ESP, "Distance", Config.ESP, "Distance")
    Toggle(pages.ESP, "Weapon", Config.ESP, "Weapon")
    Toggle(pages.ESP, "Flags", Config.ESP, "Flags")
    Section(pages.ESP, "Extra")
    Toggle(pages.ESP, "Skeleton", Config.ESP, "Skeleton")
    Toggle(pages.ESP, "Tracer", Config.ESP, "Tracer")
    Toggle(pages.ESP, "Head Dot", Config.ESP, "HeadDot")
    Toggle(pages.ESP, "Head Circle", Config.ESP, "HeadCircle")
    Toggle(pages.ESP, "Look Direction", Config.ESP, "LookDirection")
    
    Section(pages.Visuals, "Screen")
    Toggle(pages.Visuals, "FOV Circle", Config.Screen, "FOVCircle")
    Toggle(pages.Visuals, "Crosshair", Config.Screen, "Crosshair")
    Toggle(pages.Visuals, "Crosshair Dot", Config.Screen, "CrosshairDot")
    Slider(pages.Visuals, "Crosshair Size", Config.Screen, "CrosshairSize", 2, 20)
    Slider(pages.Visuals, "Crosshair Gap", Config.Screen, "CrosshairGap", 0, 15)
    Section(pages.Visuals, "Info")
    Toggle(pages.Visuals, "Watermark", Config.Screen, "Watermark")
    Toggle(pages.Visuals, "FPS Counter", Config.Screen, "FPS")
    Toggle(pages.Visuals, "Ping Display", Config.Screen, "Ping")
    Toggle(pages.Visuals, "Player Count", Config.Screen, "PlayerCount")
    Toggle(pages.Visuals, "Keybind List", Config.Screen, "KeybindList")
    Toggle(pages.Visuals, "Spectator List", Config.Screen, "SpectatorList")
    Section(pages.Visuals, "Target")
    Toggle(pages.Visuals, "Target Info", Config.Screen, "TargetInfo")
    Toggle(pages.Visuals, "Target Snapline", Config.Screen, "TargetSnapline")
    Toggle(pages.Visuals, "Hit Marker", Config.Screen, "HitMarker")
    
    -- WORLD TAB
    Section(pages.World, "Camera")
    Toggle(pages.World, "FOV Changer", Config.World, "FOVChanger")
    Slider(pages.World, "Field of View", Config.World, "FOVValue", 30, 120)
    Section(pages.World, "Lighting")
    Toggle(pages.World, "Fullbright", Config.World, "Fullbright")
    Toggle(pages.World, "No Fog", Config.World, "NoFog")
    Section(pages.World, "Time")
    Toggle(pages.World, "Custom Time", Config.World, "CustomTime")
    Slider(pages.World, "Time (Hour)", Config.World, "TimeValue", 0, 24)
    
    Section(pages.Settings, "Keybinds")
    local info = Instance.new("TextLabel", pages.Settings)
    info.Size = UDim2.new(1, 0, 0, 80)
    info.BackgroundColor3 = Color3.fromRGB(25, 25, 32)
    info.BorderSizePixel = 0
    info.Text = "  [Insert] Toggle Menu\n  [Right Alt] Toggle All\n  [End] Panic Mode\n  [RMB] Aim (hold)"
    info.TextColor3 = Color3.fromRGB(180, 180, 180)
    info.TextSize = 11
    info.Font = Enum.Font.Gotham
    info.TextXAlignment = Enum.TextXAlignment.Left
    info.TextYAlignment = Enum.TextYAlignment.Top
    Instance.new("UICorner", info).CornerRadius = UDim.new(0, 5)
    Instance.new("UIPadding", info).PaddingTop = UDim.new(0, 8)
    
    -- Drag
    local dragging, dragStart, startPos
    titleBar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = self.Main.Position
        end
    end)
    titleBar.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = false
        end
    end)
    UserInputService.InputChanged:Connect(function(input)
        if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            local delta = input.Position - dragStart
            self.Main.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        end
    end)
end

function GUI:Toggle()
    State.MenuOpen = not State.MenuOpen
    self.Main.Visible = State.MenuOpen
end

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- INIT
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

local function Initialize()
    InitScreenDrawings()
    GUI:Create()
    
    -- Input
    UserInputService.InputBegan:Connect(function(input, gpe)
        if gpe then return end
        
        if input.KeyCode == Config.Keys.Menu then
            GUI:Toggle()
        elseif input.KeyCode == Config.Keys.Toggle then
            Config.Aimbot.Enabled = not Config.Aimbot.Enabled
            Config.ESP.Enabled = not Config.ESP.Enabled
            print("Cheat:", Config.Aimbot.Enabled and "ON" or "OFF")
        elseif input.KeyCode == Config.Keys.Panic then
            State.PanicMode = not State.PanicMode
            GUI.Main.Visible = not State.PanicMode
            print("Panic:", State.PanicMode and "HIDDEN" or "VISIBLE")
        end
        
        -- RMB for aimbot
        if input.UserInputType == Enum.UserInputType.MouseButton2 then
            State.IsAiming = true
        end
    end)
    
    UserInputService.InputEnded:Connect(function(input, gpe)
        if input.UserInputType == Enum.UserInputType.MouseButton2 then
            State.IsAiming = false
            State.AimTarget = nil
        end
    end)
    
    -- Main Loop
    RunService.RenderStepped:Connect(function()
        -- Draw ESP (creates fresh drawings every frame)
        pcall(DrawESP)
        
        pcall(UpdateScreenDrawings)
        pcall(UpdateAimbot)
        pcall(UpdateTriggerbot)
        pcall(UpdateWorld)
    end)
    
    print([[
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      ğŸ¯ ULTIMATE CHEAT v5.4 LOADED
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  [Insert]     Toggle Menu
  [Right Alt]  Toggle All
  [End]        Panic Mode
  [RMB]        Hold to Aim
  
  FOV/Fullbright fixed - won't break ESP
  
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    ]])
end

Initialize()
